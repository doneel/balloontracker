<!DOCTYPE html>
<html>
          <head>
            <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
            <style type="text/css">
              html { height: 100% }
              body { height: 100%; margin: 0; padding: 0 }
              #map-canvas { height: 100%; width: 80%; }
            </style>
            <script type="text/javascript"
              src="https://maps.googleapis.com/maps/api/js?sensor=false">
            </script>

            <script type="text/javascript">
               document.write("\<script src='//ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js' type='text/javascript'>\<\/script>");
            </script>

            <script type="text/javascript">
               var pathsList = JSON.parse({{.JsonFlightData}});
             </script>

            <script type="text/javascript">


              function initialize() {
                var mapOptions = {
                  center: new google.maps.LatLng(45.220, -111.761),
                  zoom: 8
                };
                var new_map = new google.maps.Map(document.getElementById("map-canvas"),
                    mapOptions);


               displayedLines = [];
               for(var i = 0; i < pathsList.length; i++){
                    flight = pathsList[i];
                    fullObj = buildFlightRepresentation(flight, new_map);


               }

/*
                var longs = [-111.761, -111.601, -110.785, -110.074]
                var latits = [45.220, 45.268, 44.873, 44.082]

                var ll_arr = [];
                for(var i = 0; i < latits.length; i++){
                  console.log(latits[i], ' ', longs[i])
                  ll_arr[i] = new google.maps.LatLng(latits[i], longs[i]);
                }
                console.log(ll_arr);

                var Longpath = new google.maps.MVCArray(ll_arr);
                console.log(Longpath);



                var line = new google.maps.Polyline(lineOptions);
                */
              }

              google.maps.event.addDomListener(window, 'load', initialize);
            </script>

            <script>
               function buildFlightRepresentation(flight, map){
                    ll_path = [];
                    for(var reading = 0; reading < flight.Readings.length; reading++){
                          ll_path[reading] = new google.maps.LatLng(flight.Readings[reading].Latitude, flight.Readings[reading].Longitude)
                    }
                    console.log(ll_path)
                    var displayPath = new google.maps.MVCArray(ll_path)
                    var lineOptions = {
                      path : displayPath,
                      map : map,
                      editable: false,
                      draggable: false,
                      strokeColor: '#DD5522',
                      strokeOpacity: .2

                    };
                    path = new google.maps.Polyline(lineOptions);

                    var marker = new google.maps.Marker({position: new google.maps.LatLng(flight.FinalLat, flight.FinalLong), map: new_map });

                    google.maps.event.addListener(path, 'mouseover', function(event){
                         console.log(this);
                         this.setOptions({strokeOpacity: 1, editable: true});
                    });

                    google.maps.event.addListener(path, 'mouseout', function(event){
                         console.log(this);
                         this.setOptions({strokeOpacity: .2, editable: false});
                    });

                    var containerDiv = document.createElement('div');
                    containerDiv.style.border = "1px solid black";
                    var dateP = document.createElement('p');
                    dateP.text = flight.Timestamp;

                    flightRepresentation = {path: path, marker: marker, box: containerDiv}
                    return flightRepresentation;

               }
          </script>


          </head>
          <body>
            <div id="map-canvas"/>
          </body>
</html>
